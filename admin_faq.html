<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Qu·∫£n tr·ªã FAQ - Aurora Spa</title>
  <style>
    :root{ --green:#3f5846; --green-600:#395947; --green-700:#2f4032; --cream:#f6f6f4; --panel:#ffffff; --accent:#f5d979; --border:#eaeaea; --txt:#2d3a2e; }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--txt);display:flex;background:var(--cream)}

    /* Sidebar */
    .sidebar{width:240px;background:var(--green);color:#fff;display:flex;flex-direction:column}
    .brand{padding:20px 24px;font-weight:700;font-size:20px;letter-spacing:.5px}
    .menu{display:flex;flex-direction:column;gap:4px;padding:8px 8px 16px}
    .menu a{display:flex;align-items:center;gap:10px;padding:12px 16px;border-radius:8px;color:#fff;text-decoration:none;font-size:14px;opacity:.95}
    .menu a.active,.menu a:hover{background:var(--green-700);border-left:4px solid var(--accent)}
    .menu .icon{width:18px;height:18px;display:inline-block}
    .help{margin-top:auto;padding:12px 16px;color:#dfe6e1;font-size:13px;border-top:1px solid rgba(255,255,255,.15)}

    /* Main */
    .main{flex:1;display:flex;flex-direction:column;min-width:0}
    .topbar{display:flex;align-items:center;justify-content:space-between;padding:26px 36px}
    .title{font-size:40px;color:var(--green-600);font-weight:500;letter-spacing:.5px}
    .top-right{display:flex;align-items:center;gap:14px}
    .top-btn{position:relative;width:36px;height:36px;border-radius:10px;border:1px solid var(--border);background:#fff;display:grid;place-items:center;cursor:pointer}
    .dot{position:absolute;top:6px;right:6px;width:7px;height:7px;border-radius:50%;background:#ffd34d}

    /* Toolbar */
    .toolbar{display:flex;align-items:center;gap:12px;padding:0 36px 16px}
    .btn{background:#f1f2f0;border:1px solid #d6d8d5;border-radius:8px;padding:10px 14px;font-size:15px;cursor:pointer}
    .btn.primary{background:#eef2ed}
    .btn.danger{background:#b53d3d;color:#fff;border:none}
    .search{margin-left:auto;display:flex;align-items:center}
    .search input{width:320px;padding:10px 12px;border:1px solid var(--border);border-radius:8px 0 0 8px;background:#fff}
    .search .filter{border:1px solid var(--border);border-left:none;border-radius:0 8px 8px 0;background:#fff;width:44px;height:40px;display:grid;place-items:center;cursor:pointer}

    /* Bulk bar */
    .bulk{display:none;align-items:center;gap:10px;margin:0 36px 12px;padding:10px;border:1px dashed var(--border);border-radius:8px;background:#fafafa}
    .bulk.show{display:flex}

    /* Card/Table */
    .card{background:var(--panel);border-radius:12px;margin:0 36px 24px;border:1px solid var(--border);overflow:hidden}
    .table-wrap{width:100%;overflow-x:auto}
    table{width:100%;border-collapse:separate;border-spacing:0;table-layout:fixed}
    col.checkbox{width:56px}
    col.id{width:110px}
    col.visible{width:120px}
    col.update{width:220px}
    col.actions{width:120px}
    thead th{font-weight:600;text-align:left;background:#fafafa;border-bottom:1px solid var(--border);padding:14px 18px;color:#3a4b3d;white-space:nowrap}
    tbody td{padding:14px 18px;border-bottom:1px solid var(--border);font-size:14px;vertical-align:middle;white-space:nowrap}
    tbody tr:hover{background:#fbfbfb}
    .center{text-align:center}
    .cell-topic{overflow:hidden;text-overflow:ellipsis}

    /* Action buttons with SVG */
    .kebab .act{border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px;cursor:pointer;display:inline-grid;place-items:center}
    .icon-btn{width:16px;height:16px;stroke:#395947;fill:none;stroke-width:1.6px}
    .icon-trash{stroke:#b53d3d}

    /* Custom checkboxes */
    input[type="checkbox"]{accent-color:#395947;cursor:pointer}
    .vis-toggle{width:18px;height:18px}

    /* Card footer (pager) */
    .card-footer{display:flex;align-items:center;justify-content:center;gap:18px;padding:12px;border-top:1px solid var(--border)}
    .pg{width:34px;height:34px;display:grid;place-items:center;border:1px solid var(--border);border-radius:10px;background:#fff;cursor:pointer}

    /* Views */
    .view{display:none}
    .view.active{display:block}

    /* Form */
    .form-wrap{margin:0 36px 36px;background:#fff;border:1px solid var(--border);border-radius:12px;padding:24px}
    .form-grid{display:grid;grid-template-columns:180px 1fr;gap:14px 18px}
    .label{align-self:center;color:#3a4b3d}
    .input,.textarea{width:100%;border:1px solid var(--border);border-radius:8px;padding:10px 12px;background:#fff}
    .textarea{min-height:220px;resize:vertical}
    .editor-bar{grid-column:2/3;display:flex;gap:10px;margin-top:-4px;margin-bottom:8px}
    .editor-btn{width:36px;height:36px;border:1px solid var(--border);border-radius:8px;background:#fff;display:grid;place-items:center;cursor:pointer}
    .switch{display:flex;align-items:center;gap:10px}
    .actions{display:flex;justify-content:space-between;margin-top:18px}
    .actions .left{display:flex;gap:10px}
    .pill{border-radius:10px;border:1px solid var(--border);background:#fff;padding:10px 18px;cursor:pointer}
    .save{background:var(--green-600);color:#fff;border:none}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;padding:16px}
    .modal.open{display:flex}
    .dialog{background:#e0ece6;border-radius:20px;padding:28px 36px;max-width:640px;width:min(90%,640px);text-align:center;box-shadow:0 10px 30px rgba(0,0,0,.15)}
    .dialog p{margin:0 0 20px;font-size:22px;color:#2e3a2f;font-style:italic}
    .dialog .row{display:flex;gap:16px;justify-content:center}
    .danger{background:#b53d3d;color:#fff;border:none}

    @media (max-width:900px){
      .form-grid{grid-template-columns:1fr}
      .toolbar{flex-wrap:wrap}
      .search{margin-left:0;width:100%}
      .search input{flex:1;width:100%}
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="brand">Aurora Spa</div>
    <nav class="menu">
      <a href="#"><span class="icon">üë§</span>Kh√°ch h√†ng</a>
      <a href="#"><span class="icon">üíà</span>D·ªãch v·ª•</a>
      <a href="#"><span class="icon">üì∞</span>Blog</a>
      <a href="#"><span class="icon">üìÖ</span>L·ªãch h·∫πn</a>
      <a href="#"><span class="icon">üéÅ</span>∆Øu ƒë√£i</a>
      <a href="#" class="active" id="navFaq"><span class="icon">‚ùì</span>FAQ</a>
      <a href="#"><span class="icon">‚öôÔ∏è</span>C√†i ƒë·∫∑t</a>
    </nav>
    <div class="help">Help</div>
  </aside>

  <!-- Main -->
  <main class="main">
    <div class="topbar">
      <div class="title" id="pageTitle">DANH S√ÅCH FAQ</div>
      <div class="top-right">
        <button class="top-btn" title="Th√¥ng b√°o"><svg class="icon-btn" viewBox="0 0 24 24"><path d="M6 8a6 6 0 0 1 12 0v5l2 2H4l2-2V8"/><path d="M9 19a3 3 0 0 0 6 0"/></svg><span class="dot"></span></button>
        <button class="top-btn" title="Tin nh·∫Øn"><svg class="icon-btn" viewBox="0 0 24 24"><path d="M21 15a4 4 0 0 1-4 4H8l-5 4V6a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg></button>
        <button class="top-btn" title="T√†i kho·∫£n"><svg class="icon-btn" viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M20 20a8 8 0 1 0-16 0"/></svg></button>
      </div>
    </div>

    <!-- View: LIST -->
    <section id="view-list" class="view active">
      <div class="toolbar">
        <button class="btn primary" id="btnCreateTop">+ T·∫†O M·ªöI FAQ</button>
        <div class="search">
          <input id="searchInput" type="search" placeholder="T√¨m ki·∫øm" />
          <div class="filter" title="B·ªô l·ªçc">‚ò∞</div>
        </div>
      </div>

      <!-- Bulk actions -->
      <div id="bulkBar" class="bulk">
        <div id="bulkCount">0 m·ª•c ƒë√£ ch·ªçn</div>
        <button class="btn" id="bulkShow">ƒê·∫∑t HI·ªÇN TH·ªä</button>
        <button class="btn" id="bulkHide">ƒê·∫∑t ·∫®N</button>
        <button class="btn danger" id="bulkDelete">X√≥a ƒë√£ ch·ªçn</button>
      </div>

      <div class="card">
        <div class="table-wrap">
          <table id="faqTable">
            <colgroup>
              <col class="checkbox" />
              <col class="id" />
              <col />
              <col class="visible" />
              <col class="update" />
              <col class="actions" />
            </colgroup>
            <thead>
              <tr>
                <th class="center"><input id="selectAll" type="checkbox" /></th>
                <th>ID</th>
                <th>Ch·ªß ƒë·ªÅ</th>
                <th class="center">Hi·ªÉn th·ªã</th>
                <th>Th·ªùi gian c·∫≠p nh·∫≠t g·∫ßn nh·∫•t</th>
                <th class="center">H√†nh ƒë·ªông</th>
              </tr>
            </thead>
            <tbody id="faqTbody"></tbody>
          </table>
        </div>
        <div class="card-footer">
          <div class="pg" id="pgPrev">‚Äπ</div>
          <div id="pgInfo">1</div>
          <div class="pg" id="pgNext">‚Ä∫</div>
        </div>
      </div>
    </section>

    <!-- View: FORM -->
    <section id="view-form" class="view">
      <div class="toolbar">
        <button class="btn" id="btnBack">‚Üê Quay l·∫°i danh s√°ch</button>
      </div>
      <div class="form-wrap">
        <h2 style="margin:0 0 18px;color:var(--green-600);font-weight:500" id="formHeading">T·∫†O M·ªöI FAQ</h2>
        <div class="form-grid">
          <div class="label">Ch·ªß ƒë·ªÅ</div>
          <input id="fTopic" class="input" placeholder="Nh·∫≠p t√™n ch·ªß ƒë·ªÅ" />
          <div class="label">C√¢u h·ªèi</div>
          <input id="fQuestion" class="input" placeholder="Nh·∫≠p c√¢u h·ªèi" />
          <div class="label">C√¢u tr·∫£ l·ªùi</div>
          <div>
            <div class="editor-bar">
              <button class="editor-btn" title="ƒê·∫≠m" onclick="wrapSel('**','**')">B</button>
              <button class="editor-btn" title="Nghi√™ng" onclick="wrapSel('*','*')">I</button>
              <button class="editor-btn" title="CƒÉn tr√°i" onclick="alignText('left')">‚â°</button>
              <button class="editor-btn" title="CƒÉn gi·ªØa" onclick="alignText('center')">‚â£</button>
              <button class="editor-btn" title="CƒÉn ph·∫£i" onclick="alignText('right')">‚â°</button>
              <button class="editor-btn" title="Danh s√°ch" onclick="insertBullets()">‚Ä¢</button>
              <button class="editor-btn" title="X√≥a ƒë·ªãnh d·∫°ng" onclick="clearFormat()">‚®Ø</button>
            </div>
            <textarea id="fAnswer" class="textarea" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi"></textarea>
          </div>
          <div class="label">Hi·ªÉn th·ªã</div>
          <div class="switch">
            <input id="fVisible" type="checkbox" />
            <label for="fVisible">B·∫≠t / T·∫Øt</label>
          </div>
        </div>
        <div class="actions">
          <div class="left"><button class="pill" id="btnCancelForm">H·ªßy</button></div>
          <button class="pill save" id="btnSave">L∆∞u</button>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal Delete -->
  <div id="deleteModal" class="modal" role="dialog" aria-modal="true">
    <div class="dialog">
      <p>B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a FAQ n√†y kh√¥ng?<br/>H√†nh ƒë·ªông n√†y kh√¥ng th·ªÉ ho√†n t√°c.</p>
      <div class="row">
        <button class="pill" id="btnCancelDelete">H·ªßy</button>
        <button class="pill danger" id="btnConfirmDelete">X√≥a</button>
      </div>
    </div>
  </div>

  <script>
    // Demo data
    const data = [
      {id:'FAQ001', topic:'Th·ªùi gian ho·∫°t ƒë·ªông', question:'Spa m·ªü c·ª≠a khi n√†o?', answer:'Spa m·ªü c·ª≠a t·ª´ 9:00 ƒë·∫øn 21:00 h·∫±ng ng√†y.', visible:true, updated:'9:00:00 25/09/2025'},
      {id:'FAQ002', topic:'ƒê·∫∑t l·ªãch h·∫πn tr∆∞·ªõc', question:'C√≥ c·∫ßn ƒë·∫∑t l·ªãch kh√¥ng?', answer:'N√™n ƒë·∫∑t l·ªãch tr∆∞·ªõc ƒë·ªÉ tr√°nh qu√° t·∫£i v√† ch·ªù ƒë·ª£i.', visible:true, updated:'9:00:00 25/09/2025'},
      {id:'FAQ003', topic:'S·ª≠ d·ª•ng s·∫£n ph·∫©m ri√™ng', question:'T√¥i c√≥ th·ªÉ d√πng s·∫£n ph·∫©m ri√™ng?', answer:'C√≥, vui l√≤ng b√°o tr∆∞·ªõc cho k·ªπ thu·∫≠t vi√™n.', visible:true, updated:'9:00:00 25/09/2025'},
      {id:'FAQ004', topic:'ƒê·ªïi l·ªãch h·∫πn', question:'ƒê·ªïi l·ªãch th·∫ø n√†o?', answer:'Li√™n h·ªá hotline, ƒë·ªïi tr√™n app/web, ho·∫∑c g·ª≠i email.', visible:true, updated:'9:00:00 25/09/2025'},
      {id:'FAQ005', topic:'∆Øu ƒë√£i/Th·∫ª th√†nh vi√™n', question:'C√≥ ∆∞u ƒë√£i kh√¥ng?', answer:'C√≥ ch∆∞∆°ng tr√¨nh t√≠ch ƒëi·ªÉm v√† th·∫ª th√†nh vi√™n.', visible:false, updated:'9:00:00 25/09/2025'},
      {id:'FAQ006', topic:'Tr·ªÖ h·∫πn', question:'Tr·ªÖ h·∫πn th√¨ sao?', answer:'Vui l√≤ng ƒë·∫øn s·ªõm 10 ph√∫t ho·∫∑c li√™n h·ªá ƒë·ªÉ s·∫Øp x·∫øp.', visible:true, updated:'9:00:00 25/09/2025'}
    ];

    // State
    let currentPage = 1; const pageSize = 5;
    let deletingId = null; let editingIndex = null; // null => create
    let selected = new Set();

    const el = sel => document.querySelector(sel);
    const elAll = sel => Array.from(document.querySelectorAll(sel));
    const fmtNow = () => new Date().toLocaleTimeString('vi-VN',{hour12:false})+' '+new Date().toLocaleDateString('vi-VN');

    // Render list
    function renderList(){
      const tbody = el('#faqTbody');
      const q = el('#searchInput').value.toLowerCase().trim();
      const filtered = data.filter(r => !q || r.id.toLowerCase().includes(q) || r.topic.toLowerCase().includes(q) || r.question.toLowerCase().includes(q));
      const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));
      currentPage = Math.min(currentPage, totalPages);
      const start = (currentPage-1)*pageSize;
      const rows = filtered.slice(start, start+pageSize);
      tbody.innerHTML = rows.map(r=>`
        <tr data-id="${r.id}">
          <td class="center"><input class="rowSel" type="checkbox" ${selected.has(r.id)?'checked':''} /></td>
          <td class="muted">${r.id}</td>
          <td class="cell-topic" title="${r.topic}">${r.topic}</td>
          <td class="center"><input class="vis-toggle" type="checkbox" ${r.visible?'checked':''} /></td>
          <td>${r.updated}</td>
          <td class="center kebab">
            <button class="act" data-act="edit" title="Ch·ªânh s·ª≠a"><svg class="icon-btn" viewBox="0 0 24 24"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/><path d="M14.06 4.69l3.75 3.75"/></svg></button>
            <button class="act" data-act="delete" title="X√≥a"><svg class="icon-btn icon-trash" viewBox="0 0 24 24"><path d="M3 6h18"/><path d="M8 6V4h8v2"/><path d="M6 6l1 14h10l1-14"/></svg></button>
          </td>
        </tr>`).join('');
      el('#pgInfo').textContent = currentPage;

      // Row navigation only when not clicking inputs/buttons
      elAll('#faqTbody tr').forEach(tr => tr.addEventListener('click', (e)=>{
        if(e.target.closest('button')|| e.target.closest('input')) return;
        const id = tr.getAttribute('data-id');
        const idx = data.findIndex(x=>x.id===id);
        openForm(idx);
      }));

      // Row checkbox
      elAll('.rowSel').forEach(cb=>{
        cb.addEventListener('click', (e)=>{ e.stopPropagation(); });
        cb.addEventListener('change', (e)=>{
          const id = e.target.closest('tr').getAttribute('data-id');
          if(e.target.checked) selected.add(id); else selected.delete(id);
          updateBulkBar(rows);
        });
      });

      // Visibility toggle
      elAll('.vis-toggle').forEach(cb=>{
        cb.addEventListener('click', (e)=>{ e.stopPropagation(); });
        cb.addEventListener('change', (e)=>{
          const id = e.target.closest('tr').getAttribute('data-id');
          const rec = data.find(x=>x.id===id); if(rec){ rec.visible = e.target.checked; rec.updated = fmtNow(); }
          renderList();
        });
      });

      // Action buttons
      elAll('.kebab [data-act="edit"]').forEach(btn=>btn.onclick=(ev)=>{
        ev.stopPropagation();
        const id = btn.closest('tr').getAttribute('data-id');
        const idx = data.findIndex(x=>x.id===id);
        openForm(idx);
      });
      elAll('.kebab [data-act="delete"]').forEach(btn=>btn.onclick=(ev)=>{
        ev.stopPropagation();
        const id = btn.closest('tr').getAttribute('data-id');
        deletingId = id; openDelete();
      });

      // Select all (per current page)
      const all = el('#selectAll');
      all.checked = rows.length>0 && rows.every(r=>selected.has(r.id));
      all.indeterminate = !all.checked && rows.some(r=>selected.has(r.id));
      all.onclick = (e)=>{
        e.stopPropagation();
        if(all.checked){ rows.forEach(r=>selected.add(r.id)); } else { rows.forEach(r=>selected.delete(r.id)); }
        renderList(); updateBulkBar(rows);
      };

      updateBulkBar(rows);
    }

    function updateBulkBar(rows){
      const bar = el('#bulkBar');
      const count = selected.size; el('#bulkCount').textContent = count + ' m·ª•c ƒë√£ ch·ªçn';
      bar.classList.toggle('show', count>0);
    }

    // View switching
    function show(view){
      elAll('.view').forEach(v=>v.classList.remove('active'));
      el(view).classList.add('active');
      el('#pageTitle').textContent = view==='#view-list' ? 'DANH S√ÅCH FAQ' : (editingIndex==null ? 'T·∫†O M·ªöI FAQ' : 'CH·ªàNH S·ª¨A FAQ');
    }

    // Form helpers
    function clearForm(){ el('#fTopic').value=''; el('#fQuestion').value=''; el('#fAnswer').value=''; el('#fVisible').checked=false; el('#formHeading').textContent='T·∫†O M·ªöI FAQ'; editingIndex=null; }

    function openForm(idx){
      if(idx==null){ clearForm(); }
      else{ editingIndex = idx; const r = data[idx]; el('#formHeading').textContent='CH·ªàNH S·ª¨A FAQ'; el('#fTopic').value=r.topic; el('#fQuestion').value=r.question; el('#fAnswer').value=r.answer; el('#fVisible').checked=!!r.visible; }
      show('#view-form');
    }

    function saveForm(){
      const rec = { id: editingIndex==null ? autoId() : data[editingIndex].id, topic: el('#fTopic').value.trim(), question: el('#fQuestion').value.trim(), answer: el('#fAnswer').value.trim(), visible: el('#fVisible').checked, updated: fmtNow() };
      if(!rec.topic || !rec.question){ alert('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß Ch·ªß ƒë·ªÅ v√† C√¢u h·ªèi'); return; }
      if(editingIndex==null){
        // Th√™m m·ªõi: ƒë∆∞a l√™n ƒê·∫¶U danh s√°ch v√† quay v·ªÅ trang 1 ƒë·ªÉ th·∫•y ngay
        data.unshift(rec); currentPage = 1;
      } else {
        data[editingIndex]=rec;
      }
      selected.clear();
      renderList(); show('#view-list');
    }

    function autoId(){ const num = Math.max(0,...data.map(d=>+d.id.replace(/\D/g,'')))+1; return 'FAQ'+String(num).padStart(3,'0'); }

    // Delete modal
    function openDelete(){ el('#deleteModal').classList.add('open'); }
    function closeDelete(){ el('#deleteModal').classList.remove('open'); deletingId=null; }

    // Simple editor helpers
    function wrapSel(pre,post){ const ta=el('#fAnswer'); const s=ta.selectionStart,e=ta.selectionEnd; const v=ta.value; ta.value=v.slice(0,s)+pre+v.slice(s,e)+post+v.slice(e); ta.focus(); ta.selectionStart=s+pre.length; ta.selectionEnd=e+pre.length; }
    function alignText(dir){ el('#fAnswer').style.textAlign=dir; }
    function insertBullets(){ const ta=el('#fAnswer'); const lines=ta.value.split('\n').map(l=> l? '‚Ä¢ '+l : l); ta.value=lines.join('\n'); }
    function clearFormat(){ const ta=el('#fAnswer'); ta.style.textAlign='left'; }

    // Bulk actions
    el('#bulkShow').onclick=()=>{ selected.forEach(id=>{ const r=data.find(x=>x.id===id); if(r){ r.visible=true; r.updated=fmtNow(); }}); renderList(); };
    el('#bulkHide').onclick=()=>{ selected.forEach(id=>{ const r=data.find(x=>x.id===id); if(r){ r.visible=false; r.updated=fmtNow(); }}); renderList(); };
    el('#bulkDelete').onclick=()=>{ for(const id of Array.from(selected)){ const i=data.findIndex(x=>x.id===id); if(i>-1) data.splice(i,1); selected.delete(id);} renderList(); updateBulkBar(); };

    // Events
    el('#btnCreateTop').onclick=()=>openForm(null);
    el('#btnBack').onclick=()=>{ show('#view-list'); };
    el('#btnCancelForm').onclick=()=>{ show('#view-list'); };
    el('#btnSave').onclick=saveForm;
    el('#searchInput').oninput=()=>{ currentPage=1; renderList(); };
    el('#btnCancelDelete').onclick=closeDelete;
    el('#btnConfirmDelete').onclick=()=>{ if(deletingId){ const i=data.findIndex(r=>r.id===deletingId); if(i>-1) data.splice(i,1); renderList(); } closeDelete(); };

    // Init
    renderList();
  </script>
</body>
</html>
